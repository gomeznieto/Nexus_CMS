@using Backend_portafolio.Entities
@model SourceViewModel

@{
    ViewData["Title"] = "Crear Fuente";
}

<h1 class="mb-3">Crear Fuente</h1>
<p class="fs-6 mb-5">Las fuentes nos permiten poder agrupar los links externos que pongamos en las entradas</p>
<div asp-validation-summary="ModelOnly" class="text-danger"></div>
@* FORMULARIO *@
<form asp-controller="Sources" asp-action="Crear" enctype="multipart/form-data">
    <input type="hidden" asp-for="user_id" />
    <input type="hidden" asp-for="icon" id="sourceIcon" />
    <div class="mb-3">
        <div class="mb-2">
            <select class="form-select select-style" onchange="addSource(this)">
                <option disabled selected>Seleccione una Fuente</option>
                @foreach (var source in Model.Default)
                {
                    <option value="@source.Name" icon="@source.IconUrl">@source.Name</option>
                }
                <option value="otra">Otra</option>
            </select>
        </div>

        <div class="w-75 mb-3 hide" id="sourceNameEl">
            <input type="text" id="sourceName" asp-for="name" class="form-control" placeholder="Indique el nombre del tipo de la fuente" />
            <span asp-validation-for="name" class="text-borrador fs-6 mt-1"></span>
        </div>
        <div class="w-75 hide" id="sourceImageEl">
            <input type="file" id="image" name="ImageFile" accept="image/*" asp-for="ImageFile" class="form-control mt-2" required>
        </div>
        <button type="submit" class="btn btn-action mt-3">Crear</button>
        <a asp-action="Index" class="btn btn-delete mt-3">cancelar</a>
    </div>
</form>

@section Scripts
{
    <partial name="_ValidationScriptsPartial" />
}

<script>
    function addSource(element)
    {
        let selected = element.options[element.selectedIndex];
        let sourceNameEl = document.getElementById("sourceNameEl");
        let sourceName = document.getElementById("sourceName");
        let sourceImageEl = document.getElementById("sourceImageEl");
        let sourceIcon = document.getElementById("sourceIcon");

        if(selected.value == 'otra')
        {
            // MOSTRAR OPCIONES
            sourceNameEl.classList.remove("hide");
            sourceImageEl.classList.remove("hide");
        }
        else
        {
            // OCULTAR OPCIONES DE CREACION
            sourceNameEl.classList.add("hide");
            sourceImageEl.classList.add("hide");

            sourceIcon.value = selected.getAttribute("icon");
            sourceName.value = selected.value;
        }
    }
</script>